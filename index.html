<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Whale Card - ‡∏™‡∏±‡πà‡∏á‡∏ó‡∏≥‡πÄ‡∏ß‡πá‡∏ö‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏™‡∏∏‡∏î‡∏û‡∏¥‡πÄ‡∏®‡∏©</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Mali:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Mali', cursive;
            background-color: #f0f9ff;
        }
        .form-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border: 2px solid #e0f2fe;
        }
        .input-focus:focus {
            outline: none;
            border-color: #7dd3fc;
            box-shadow: 0 0 0 3px rgba(125, 211, 252, 0.3);
        }
        .required-label::after {
            content: " *";
            color: #ef4444;
        }
        .image-preview-slot {
            aspect-ratio: 1;
            border: 2px dashed #e0f2fe;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            border-radius: 1rem;
            background: #fff;
            position: relative;
            transition: all 0.3s ease;
        }
        .image-preview-slot img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .delete-btn {
            position: absolute;
            top: 4px;
            right: 4px;
            background: #ef4444;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            cursor: pointer;
            z-index: 10;
            border: 1px solid white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        .loader {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3498db;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
            display: inline-block;
            margin-right: 8px;
            vertical-align: middle;
        }
        .whale-swim {
            animation: swim 3s ease-in-out infinite;
        }
        @keyframes swim {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-15px) rotate(5deg); }
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .animate-pop {
            animation: pop 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        @keyframes pop {
            0% { transform: scale(0.8); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }
        .warning-modal {
            border-top: 8px solid #fbbf24;
        }
        .confirm-modal {
            border-top: 8px solid #0ea5e9;
        }
    </style>
</head>
<body class="min-h-screen py-10 px-4">
    <div class="max-w-2xl mx-auto">
        <!-- Logo & Header -->
        <div class="text-center mb-10">
            <img src="https://i.ibb.co/k268SxR2/WHALE3.png" alt="Whale Logo" class="w-32 h-32 mx-auto mb-4 drop-shadow-lg object-contain">
            <h1 class="text-3xl font-bold text-sky-600 mb-2">Whale Web Card</h1>
            <p class="text-sky-400 text-sm">‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏£‡∏á‡∏à‡∏≥‡∏î‡∏µ‡πÜ ‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏ß‡πá‡∏ö‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏™‡∏∏‡∏î‡∏ô‡πà‡∏≤‡∏£‡∏±‡∏Å (Create special memories)</p>
        </div>

        <!-- Form Container -->
        <div class="form-card rounded-3xl p-8 shadow-xl">
            <form id="orderForm" class="space-y-6">
                <!-- 1. ‡πÄ‡∏ß‡πá‡∏ö‡∏Å‡∏≤‡∏£‡πå‡∏î‡πÅ‡∏ô‡∏ß‡πÑ‡∏´‡∏ô -->
                <div>
                    <label class="block text-sky-700 font-bold mb-2 required-label">üéà ‡πÄ‡∏ß‡πá‡∏ö‡∏Å‡∏≤‡∏£‡πå‡∏î‡πÅ‡∏ô‡∏ß‡πÑ‡∏´‡∏ô? (Card Category)</label>
                    <input type="text" name="‡πÅ‡∏ô‡∏ß‡∏Å‡∏≤‡∏£‡πå‡∏î" id="card_type" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î , ‡∏ß‡∏±‡∏ô‡∏Ñ‡∏£‡∏ö‡∏£‡∏≠‡∏ö , ‡∏ß‡∏±‡∏ô‡∏ß‡∏≤‡πÄ‡∏•‡∏ô‡πÑ‡∏ó‡∏ô‡πå" class="w-full p-3 rounded-xl border-2 border-sky-100 input-focus transition-all">
                </div>

                <!-- ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç -->
                <div>
                    <label class="block text-sky-700 font-bold mb-1">üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç (Date) - ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏ö‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö</label>
                    <input type="text" name="‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç" placeholder="‡πÄ‡∏ß‡πá‡∏ö ‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î , ‡πÄ‡∏ß‡πá‡∏ö‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏ß‡∏±‡∏ô‡∏Ñ‡∏£‡∏ö‡∏£‡∏≠‡∏ö ‡πÄ‡∏ä‡πà‡∏ô 14/02/69" class="w-full p-3 rounded-xl border-2 border-sky-100 input-focus transition-all">
                    <p class="text-[10px] text-red-500 mt-1 ml-1 leading-tight">* ‡∏´‡∏≤‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏ß‡πá‡∏ö‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏ß‡∏±‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏õ‡∏µ ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏™‡πà‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏ô‡∏µ‡πâ</p>
                </div>

                <!-- ‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô & ‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏© -->
                <div class="flex flex-col md:flex-row gap-4">
                    <div class="flex-1">
                        <label class="block text-sky-700 font-bold mb-2 required-label">üë§ ‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì (Your Nickname)</label>
                        <input type="text" name="‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì" id="customer_name" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì" class="w-full p-3 rounded-xl border-2 border-sky-100 input-focus transition-all">
                    </div>
                    <div class="flex-1">
                        <label class="block text-sky-700 font-bold mb-2 required-label">üíñ ‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏© (Receiver Name)</label>
                        <input type="text" name="‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©" id="receiver_name" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö" class="w-full p-3 rounded-xl border-2 border-sky-100 input-focus transition-all">
                    </div>
                </div>

                <!-- ‡πÇ‡∏ó‡∏ô‡∏™‡∏µ ‡πÅ‡∏•‡∏∞ ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô -->
                <div class="flex flex-col md:flex-row gap-4">
                    <div class="flex-1">
                        <label class="block text-sky-700 font-bold mb-2 required-label">üé® ‡πÇ‡∏ó‡∏ô‡∏™‡∏µ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ (Color Tone)</label>
                        <input type="text" name="‡πÇ‡∏ó‡∏ô‡∏™‡∏µ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ" id="color_tone" placeholder="‡πÄ‡∏ä‡πà‡∏ô #ff86b0 , #da3371 , #f18daf" class="w-full p-3 rounded-xl border-2 border-sky-100 input-focus transition-all">
                        <p class="text-[10px] text-red-500 mt-1 ml-1 leading-tight">* ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏£‡∏∞‡∏ö‡∏∏‡πÇ‡∏Ñ‡πâ‡∏î‡∏™‡∏µ‡πÑ‡∏î‡πâ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 1 ‡∏™‡∏µ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏á‡∏≤‡∏ô‡∏≠‡∏≠‡∏Å‡∏°‡∏≤‡∏ï‡∏£‡∏á‡πÉ‡∏à‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏Ñ‡∏£‡∏±‡∏ö</p>
                    </div>
                    <div class="flex-1">
                        <label class="block text-sky-700 font-medium mb-2">üîí ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å (Passcode)</label>
                        <input type="text" name="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô" id="passcode" maxlength="4" placeholder="‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç 4 ‡∏´‡∏•‡∏±‡∏Å" class="w-full p-3 rounded-xl border border-sky-100 input-focus transition-all">
                    </div>
                </div>

                <!-- ‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÄ‡∏û‡∏•‡∏á‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö -->
                <div>
                    <label class="block text-sky-700 font-bold mb-2 required-label">üéµ ‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÄ‡∏û‡∏•‡∏á‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö (Music URL)</label>
                    <input type="url" name="‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÄ‡∏û‡∏•‡∏á" id="music_url" placeholder="‡πÄ‡∏ä‡πà‡∏ô https://www.youtube.com/watch?v=..." class="w-full p-3 rounded-xl border-2 border-sky-100 input-focus transition-all">
                </div>

                <hr class="border-sky-50">

                <!-- ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û -->
                <div>
                    <label class="block text-sky-700 font-bold mb-1">üì∏ ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û (Upload Images)</label>
                    <p class="text-[11px] text-red-500 mb-2 ml-1 leading-tight font-medium">* ‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 5 ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û ‡πÅ‡∏•‡∏∞‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 10 MB ‡∏ï‡πà‡∏≠‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û (‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏°‡πà‡πÉ‡∏™‡πà‡πÑ‡∏î‡πâ)</p>
                    
                    <div class="grid grid-cols-5 gap-2 mb-3" id="imagePreviewContainer">
                        <div class="image-preview-slot" id="slot-0"><span class="text-xs text-sky-200">1</span></div>
                        <div class="image-preview-slot" id="slot-1"><span class="text-xs text-sky-200">2</span></div>
                        <div class="image-preview-slot" id="slot-2"><span class="text-xs text-sky-200">3</span></div>
                        <div class="image-preview-slot" id="slot-3"><span class="text-xs text-sky-200">4</span></div>
                        <div class="image-preview-slot" id="slot-4"><span class="text-xs text-sky-200">5</span></div>
                    </div>
                    <input type="file" id="imageInput" accept="image/*" multiple class="block w-full text-sm text-sky-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-sky-50 file:text-sky-700 hover:file:bg-sky-100">
                </div>

                <!-- ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° -->
                <div>
                    <label class="block text-sky-700 font-medium mb-2">üìù ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°/‡∏Ñ‡∏≥‡∏≠‡∏ß‡∏¢‡∏û‡∏£ (Wishes/Message)</label>
                    <textarea name="‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°" id="message" rows="3" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì..." class="w-full p-3 rounded-xl border border-sky-100 input-focus transition-all resize-none"></textarea>
                </div>

                <!-- Consent Section -->
                <div class="border-t border-sky-50 pt-6 space-y-4">
                    <label class="flex items-start gap-3 cursor-pointer group">
                        <div class="relative flex items-center h-5">
                            <input type="checkbox" id="consent_checkbox" class="w-5 h-5 rounded border-2 border-sky-200 text-sky-500 focus:ring-sky-500 cursor-pointer">
                        </div>
                        <div class="text-sm text-sky-800 leading-relaxed">
                            <p class="font-bold mb-1">‡∏Ç‡πâ‡∏≠‡∏ï‡∏Å‡∏•‡∏á‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏¥‡∏ô‡∏¢‡∏≠‡∏° (Consent Agreement)</p>
                            <p class="text-gray-600">
                                ‡∏Ç‡πâ‡∏≤‡∏û‡πÄ‡∏à‡πâ‡∏≤‡∏¢‡∏¥‡∏ô‡∏¢‡∏≠‡∏°‡πÉ‡∏´‡πâ‡∏£‡πâ‡∏≤‡∏ô <span class="font-bold text-sky-600">WHALE</span> ‡∏à‡∏±‡∏î‡πÄ‡∏Å‡πá‡∏ö‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏• (‡πÄ‡∏ä‡πà‡∏ô ‡∏ä‡∏∑‡πà‡∏≠ ‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡πÜ) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏£‡∏£‡∏Ñ‡πå‡πÄ‡∏ß‡πá‡∏ö‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏ï‡∏≤‡∏°‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡πÇ‡∏î‡∏¢‡∏ó‡∏≤‡∏á‡∏£‡πâ‡∏≤‡∏ô‡∏Ç‡∏≠‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡πÄ‡∏ú‡∏¢‡πÅ‡∏û‡∏£‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡∏à‡∏≤‡∏Å‡∏ó‡πà‡∏≤‡∏ô
                            </p>
                            <p class="text-xs text-red-500 font-semibold italic mt-2 underline">
                                * ‡∏´‡πâ‡∏≤‡∏°‡∏ô‡∏≥‡πÄ‡∏ó‡∏°‡πÄ‡∏û‡∏•‡∏ï‡πÑ‡∏õ‡πÅ‡∏à‡∏Å‡∏à‡πà‡∏≤‡∏¢‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ‡πÄ‡∏ä‡∏¥‡∏á‡∏û‡∏≤‡∏ì‡∏¥‡∏ä‡∏¢‡πå‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï ‡∏´‡∏≤‡∏Å‡∏û‡∏ö‡πÄ‡∏´‡πá‡∏ô‡∏à‡∏∞‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Ñ‡∏î‡∏µ‡∏ï‡∏≤‡∏°‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ñ‡∏∂‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î
                            </p>
                        </div>
                    </label>
                </div>

                <!-- Submit Button -->
                <button type="submit" id="submitBtn" class="w-full bg-sky-500 hover:bg-sky-600 text-white font-bold py-4 rounded-2xl shadow-lg transition-all transform hover:scale-[1.02] active:scale-95 flex justify-center items-center">
                    <span id="btnText">‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ó‡∏≥ ‚ú®</span>
                </button>
            </form>
        </div>

        <!-- Confirm Modal -->
        <div id="confirmModal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden items-center justify-center p-4 z-[80]">
            <div class="bg-white rounded-3xl p-8 max-w-sm w-full text-center shadow-2xl animate-pop confirm-modal">
                <div class="text-4xl mb-4">üêã</div>
                <h3 class="text-xl font-bold text-gray-800 mb-2">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢</h3>
                <p class="text-gray-500 text-sm mb-6 leading-relaxed">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà? ‡∏´‡∏≤‡∏Å‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡∏ô‡πâ‡∏≠‡∏á‡∏ß‡∏≤‡∏¨‡∏à‡∏∞‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ô‡∏≥‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö</p>
                <div class="flex gap-3">
                    <button onclick="closeConfirm()" class="flex-1 bg-gray-100 hover:bg-gray-200 text-gray-600 py-3 rounded-xl font-bold transition-colors">‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button>
                    <button id="finalConfirmBtn" class="flex-1 bg-sky-500 hover:bg-sky-600 text-white py-3 rounded-xl font-bold transition-colors shadow-md shadow-sky-200">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á</button>
                </div>
            </div>
        </div>

        <!-- Custom Warning Modal -->
        <div id="warningModal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden items-center justify-center p-4 z-[70]">
            <div class="bg-white rounded-3xl p-8 max-w-sm w-full text-center shadow-2xl animate-pop warning-modal">
                <div class="text-4xl mb-4">‚ö†Ô∏è</div>
                <h3 class="text-xl font-bold text-gray-800 mb-2">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô</h3>
                <p id="warningMessage" class="text-gray-500 text-sm mb-6 leading-relaxed"></p>
                <button onclick="closeWarning()" class="w-full bg-amber-400 hover:bg-amber-500 text-white py-3 rounded-xl font-bold transition-colors">‡∏£‡∏±‡∏ö‡∏ó‡∏£‡∏≤‡∏ö</button>
            </div>
        </div>

        <!-- Uploading Modal -->
        <div id="uploadingModal" class="fixed inset-0 bg-sky-900/40 backdrop-blur-sm hidden items-center justify-center p-4 z-[60]">
            <div class="bg-white rounded-3xl p-10 max-w-sm w-full text-center shadow-2xl animate-pop">
                <div class="whale-swim mb-6">
                    <img src="https://i.ibb.co/k268SxR2/WHALE3.png" alt="Whale Loading" class="w-24 h-24 mx-auto object-contain">
                </div>
                <h3 class="text-2xl font-bold text-sky-600 mb-2">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡πÑ‡∏õ‡∏´‡∏≤‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå...</h3>
                <p class="text-gray-500 text-sm mb-4">‡∏ô‡πâ‡∏≠‡∏á‡∏ß‡∏≤‡∏¨‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ï‡∏±‡πâ‡∏á‡πÉ‡∏à ‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà‡∏Ñ‡∏£‡∏±‡∏ö</p>
                <div class="bg-sky-50 rounded-full px-4 py-2 inline-flex items-center gap-2 mb-2">
                    <span class="loader border-sky-500 border-t-white"></span>
                    <span class="text-sky-600 font-bold text-xs">‡∏Ñ‡∏≤‡∏î‡∏ß‡πà‡∏≤‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 3 - 5 ‡∏ô‡∏≤‡∏ó‡∏µ</span>
                </div>
            </div>
        </div>

        <!-- Success Modal -->
        <div id="successModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50">
            <div class="bg-white rounded-3xl p-8 max-w-sm w-full text-center shadow-2xl">
                <div class="text-5xl mb-4">üê≥</div>
                <h3 class="text-2xl font-bold text-sky-600 mb-2">‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</h3>
                <p class="text-gray-500 mb-6">‡∏£‡∏±‡∏ö‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏£‡∏±‡∏ö</p>
                <button onclick="closeModal()" class="w-full bg-sky-500 text-white py-3 rounded-xl font-bold">‡∏ï‡∏Å‡∏•‡∏á</button>
            </div>
        </div>
    </div>

    <script>
        // Updated SCRIPT_URL to the latest version provided by user
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxgCrPS_pFx7m9kKH6i-BSoNAiXex7pXJVdpCLd_gsjeq644k-hFbvzNvjcopdNtmZe/exec';
        let uploadedImagesBase64 = [];
        const MAX_FILES = 5;
        const MAX_SIZE_MB = 10;

        document.getElementById('imageInput').addEventListener('change', function(e) {
            const files = Array.from(e.target.files);
            if (uploadedImagesBase64.length + files.length > MAX_FILES) {
                showWarning(`‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÑ‡∏î‡πâ‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô ${MAX_FILES} ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏Ñ‡∏£‡∏±‡∏ö`);
                this.value = "";
                return;
            }
            files.forEach((file) => {
                if (file.size > MAX_SIZE_MB * 1024 * 1024) {
                    showWarning(`‡πÑ‡∏ü‡∏•‡πå "${file.name}" ‡∏°‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà‡πÄ‡∏Å‡∏¥‡∏ô 10MB ‡∏Ñ‡∏£‡∏±‡∏ö`);
                    return;
                }
                const reader = new FileReader();
                reader.onload = function(event) {
                    if (uploadedImagesBase64.length < MAX_FILES) {
                        uploadedImagesBase64.push(event.target.result);
                        renderPreviews();
                    }
                };
                reader.readAsDataURL(file);
            });
            this.value = "";
        });

        function renderPreviews() {
            for(let i=0; i<5; i++) {
                const slot = document.getElementById(`slot-${i}`);
                slot.innerHTML = `<span class="text-xs text-sky-200">${i+1}</span>`;
            }
            uploadedImagesBase64.forEach((base64, index) => {
                const slot = document.getElementById(`slot-${index}`);
                slot.innerHTML = `
                    <img src="${base64}">
                    <div class="delete-btn" onclick="removeImage(${index})">‚úï</div>
                `;
            });
        }

        function removeImage(index) {
            uploadedImagesBase64.splice(index, 1);
            renderPreviews();
        }

        function showWarning(msg) {
            document.getElementById('warningMessage').innerText = msg;
            const modal = document.getElementById('warningModal');
            modal.classList.remove('hidden');
            modal.classList.add('flex');
        }

        function closeWarning() {
            const modal = document.getElementById('warningModal');
            modal.classList.add('hidden');
            modal.classList.remove('flex');
        }

        function showConfirm() {
            const modal = document.getElementById('confirmModal');
            modal.classList.remove('hidden');
            modal.classList.add('flex');
        }

        function closeConfirm() {
            const modal = document.getElementById('confirmModal');
            modal.classList.add('hidden');
            modal.classList.remove('flex');
        }

        function validateForm() {
            const requiredFields = [
                { id: 'card_type', label: '‡πÅ‡∏ô‡∏ß‡πÄ‡∏ß‡πá‡∏ö‡∏Å‡∏≤‡∏£‡πå‡∏î' },
                { id: 'customer_name', label: '‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì' },
                { id: 'receiver_name', label: '‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©' },
                { id: 'color_tone', label: '‡πÇ‡∏ó‡∏ô‡∏™‡∏µ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ' },
                { id: 'music_url', label: '‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÄ‡∏û‡∏•‡∏á‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö' }
            ];

            for (let field of requiredFields) {
                const val = document.getElementById(field.id).value.trim();
                if (!val) {
                    showWarning(`‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏ "${field.label}" ‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡∏Å‡πà‡∏≠‡∏ô‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏£‡∏±‡∏ö`);
                    document.getElementById(field.id).focus();
                    return false;
                }
            }

            const passcode = document.getElementById('passcode').value.trim();
            if (passcode && (!/^\d{4}$/.test(passcode))) {
                showWarning('‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô "‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç 4 ‡∏´‡∏•‡∏±‡∏Å" ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö');
                document.getElementById('passcode').focus();
                return false;
            }

            const musicUrl = document.getElementById('music_url').value.trim();
            try {
                new URL(musicUrl);
            } catch (_) {
                showWarning('‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÄ‡∏û‡∏•‡∏á‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏Ñ‡∏£‡∏±‡∏ö');
                document.getElementById('music_url').focus();
                return false;
            }

            if (!document.getElementById('consent_checkbox').checked) {
                showWarning('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏≠‡πà‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏Å‡∏î‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏ï‡∏Å‡∏•‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß‡∏Å‡πà‡∏≠‡∏ô‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏£‡∏±‡∏ö');
                return false;
            }

            return true;
        }

        document.getElementById('orderForm').addEventListener('submit', function(e) {
            e.preventDefault();
            if (validateForm()) {
                showConfirm();
            }
        });

        document.getElementById('finalConfirmBtn').addEventListener('click', async function() {
            closeConfirm();
            await performSubmit();
        });

        async function performSubmit() {
            const btn = document.getElementById('submitBtn');
            const btnText = document.getElementById('btnText');
            const uploadingModal = document.getElementById('uploadingModal');
            
            btn.disabled = true;
            btnText.innerHTML = '<span class="loader"></span> ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...';
            uploadingModal.classList.remove('hidden');
            uploadingModal.classList.add('flex');

            const formData = new FormData(document.getElementById('orderForm'));
            const data = Object.fromEntries(formData.entries());
            
            // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÉ‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡∏ü‡∏¥‡∏•‡∏î‡πå‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢ "‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û"
            data['‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û'] = JSON.stringify(uploadedImagesBase64);

            try {
                const params = new URLSearchParams();
                for (const key in data) {
                    params.append(key, data[key]);
                }

                await fetch(SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                    body: params.toString(),
                });

                uploadingModal.classList.add('hidden');
                uploadingModal.classList.remove('flex');
                showSuccess();
            } catch (error) {
                console.error('Error:', error);
                uploadingModal.classList.add('hidden');
                showWarning('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏Ñ‡∏£‡∏±‡∏ö');
                resetBtn();
            }
        }

        function showSuccess() {
            document.getElementById('successModal').classList.remove('hidden');
            document.getElementById('successModal').classList.add('flex');
            resetBtn();
        }

        function resetBtn() {
            const btn = document.getElementById('submitBtn');
            const btnText = document.getElementById('btnText');
            btn.disabled = false;
            btnText.innerHTML = '‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ó‡∏≥ ‚ú®';
        }

        function closeModal() {
            document.getElementById('successModal').classList.add('hidden');
            document.getElementById('orderForm').reset();
            uploadedImagesBase64 = [];
            renderPreviews();
        }
    </script>
</body>
</html>
